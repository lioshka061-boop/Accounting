<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Статистика</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script defer src="/main.js"></script>
</head>

<body>

<div class="mobile-header">
  <button class="burger-btn">☰</button>
  <div class="mobile-title">Статистика</div>
</div>
<div class="sidebar">
  <h2>Облік</h2>

  <a href="/orders.html">Замовлення</a>
  <a href="/create-order.html">Нове замовлення</a>
  <a href="/suppliers.html">Постачальники</a>
  <a href="/stats.html" class="active">Статистика</a>
  <a href="/index.html">Головна</a>
</div>
<div class="sidebar-backdrop"></div>

<div class="content">
  <h1>Статистика</h1>

  <div class="filters" style="margin-bottom:16px;">
    <input type="date" id="stats-start" placeholder="Від" />
    <input type="date" id="stats-end" placeholder="До" />
    <button id="stats-apply">Застосувати період</button>
    <button id="stats-reset">Скинути період</button>
  </div>

  <div class="stats-grid">

    <div class="stat-card">
      <h3>Виручка за весь час</h3>
      <p id="total-sales">0 ₴</p>
    </div>

    <div class="stat-card">
      <h3>Прибуток за весь час</h3>
      <p id="total-profit">0 ₴</p>
    </div>

    <div class="stat-card">
      <h3>Постачальники винні тобі</h3>
      <p id="suppliers-owe-you">0 ₴</p>
    </div>

    <div class="stat-card">
      <h3>Ти винен постачальникам</h3>
      <p id="you-owe-suppliers">0 ₴</p>
    </div>

    <div class="stat-card">
      <h3>Маржа (всього)</h3>
      <p id="total-margin">0 %</p>
    </div>

  </div>

  <div class="charts-grid">
    <div class="chart-card">
      <h3>Динаміка прибутку</h3>
      <canvas id="profit-chart" height="220"></canvas>
    </div>
    <div class="chart-card">
      <h3>Виручка vs Прибуток</h3>
      <canvas id="revenue-chart" height="220"></canvas>
    </div>
  </div>

  <div class="charts-grid">
    <div class="chart-card">
      <h3>Маржа по місяцях</h3>
      <canvas id="margin-chart" height="220"></canvas>
    </div>
    <div class="chart-card">
      <h3>Місячні показники</h3>
      <canvas id="monthly-chart" height="220"></canvas>
    </div>
  </div>

  <div class="chart-card wide">
    <h3>Баланс постачальників</h3>
    <canvas id="suppliers-chart" height="220"></canvas>
  </div>

  <div class="chart-card wide">
    <h3>Маржа постачальників</h3>
    <canvas id="suppliers-perf-chart" height="220"></canvas>
  </div>

  <div class="table-box" style="margin-top:12px;">
    <table id="suppliers-summary">
      <thead>
        <tr>
          <th>Постачальник</th>
          <th>Замовлень</th>
          <th>Оборот</th>
          <th>Прибуток</th>
          <th>Маржа %</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="table-box" style="margin-top:12px;">
    <table id="monthly-summary">
      <thead>
        <tr>
          <th>Місяць</th>
          <th>Оборот</th>
          <th>Чистий прибуток</th>
          <th>Замовлень</th>
          <th>Середній чек</th>
          <th>Маржа %</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="card" style="margin-top:12px;">
    <h3>Додати дані за місяць</h3>
    <div class="flex-row gap-sm" style="margin-top:8px; flex-wrap:wrap;">
      <div>
        <label>Місяць</label>
        <input type="month" id="manual-month" style="max-width:180px;">
      </div>
      <div>
        <label>Оборот (₴)</label>
        <input type="number" id="manual-revenue" placeholder="0" style="max-width:140px;">
      </div>
      <div>
        <label>Чистий прибуток (₴)</label>
        <input type="number" id="manual-profit" placeholder="0" style="max-width:140px;">
      </div>
      <div>
        <label>Замовлень</label>
        <input type="number" id="manual-orders" placeholder="0" style="max-width:120px;">
      </div>
      <div style="align-self:flex-end;">
        <button id="manual-save">Зберегти</button>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:16px;">
    <div class="flex-row">
      <div style="flex:1;">
        <h3>План на день</h3>
        <div class="flex-row gap-sm">
          <label style="margin:0;">Ціль, грн</label>
          <input type="number" id="plan-target" value="3000" style="max-width:160px;" />
          <button id="plan-refresh">Оновити</button>
        </div>
      </div>
      <div class="plan-cards">
        <div class="mini-card">
          <div class="mini-title">Продажі сьогодні</div>
          <div class="mini-value" id="today-revenue">0 ₴</div>
        </div>
        <div class="mini-card">
          <div class="mini-title">Чистий прибуток</div>
          <div class="mini-value" id="today-profit">0 ₴</div>
        </div>
        <div class="mini-card">
          <div class="mini-title">Замовлень</div>
          <div class="mini-value" id="today-count">0</div>
        </div>
        <div class="mini-card highlight">
          <div class="mini-title">Залишок до плану</div>
          <div class="mini-value" id="today-remaining">0 ₴</div>
        </div>
        <div class="mini-card">
          <div class="mini-title">Недобір попередніх днів</div>
          <div class="mini-value" id="plan-shortfall">0 ₴</div>
        </div>
      </div>
    </div>
    <div class="flex-row">
      <div style="flex:1;">
        <h4 style="margin:12px 0 8px;">Джерела сьогодні</h4>
        <ul id="today-sources" class="source-list"></ul>
      </div>
    </div>
  </div>

  <div class="table-box" style="margin-top:12px;">
    <table id="daily-table">
      <thead>
        <tr>
          <th>Дата</th>
          <th>Виручка</th>
          <th>Прибуток</th>
          <th>Маржа %</th>
          <th>Замовлень</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

</div>

</body>
</html>
